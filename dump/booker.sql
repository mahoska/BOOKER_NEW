-- phpMyAdmin SQL Dump
-- version 4.5.1
-- http://www.phpmyadmin.net
--
-- Хост: 127.0.0.1
-- Время создания: Ноя 10 2017 г., 08:56
-- Версия сервера: 10.1.19-MariaDB
-- Версия PHP: 7.0.13

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- База данных: `booker`
--

-- --------------------------------------------------------

--
-- Структура таблицы `eventbooker`
--

CREATE TABLE `eventbooker` (
  `id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `room_id` int(11) NOT NULL,
  `description` text NOT NULL,
  `start_event` bigint(20) NOT NULL,
  `start_event_format` varchar(20) NOT NULL,
  `end_event` bigint(20) NOT NULL,
  `end_event_format` varchar(20) NOT NULL,
  `data_create` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `parent_event_id` int(11) DEFAULT NULL,
  `is_repeat` tinyint(1) DEFAULT '0'
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- Дамп данных таблицы `eventbooker`
--

INSERT INTO `eventbooker` (`id`, `user_id`, `room_id`, `description`, `start_event`, `start_event_format`, `end_event`, `end_event_format`, `data_create`, `parent_event_id`, `is_repeat`) VALUES
(27, 1, 1, 'test1', 1509966000, '11.06.17 13:00:00', 1509971400, '11.06.17 14:30:00', '2017-11-04 19:04:11', NULL, 0),
(28, 1, 1, 'test1', 1509962400, '11.06.17 12:00:00', 1509964200, '11.06.17 12:30:00', '2017-11-04 19:04:40', NULL, 0),
(47, 1, 1, 'event22', 1511339400, '11.22.17 10:30:00', 1511344800, '11.22.17 12:00:00', '2017-11-05 23:40:29', NULL, 1),
(49, 1, 1, 'event22', 1510475400, '11.12.17 10:30:00', 1510480800, '11.12.17 12:00:00', '2017-11-05 23:43:51', NULL, 1),
(50, 1, 1, 'event22', 1511080200, '11.19.17 10:30:00', 1511085600, '11.19.17 12:00:00', '2017-11-05 23:43:51', 49, 0),
(51, 1, 1, 'event22', 1510561800, '11.13.17 10:30:00', 1510567200, '11.13.17 12:00:00', '2017-11-05 23:45:17', NULL, 1),
(52, 3, 1, 'event', 1511177400, '20.11.17 13:30:00', 1511179200, '20.11.17 14:00:00', '2017-11-05 23:45:17', 51, 0),
(53, 4, 1, 'event', 1510655400, '14.11.17 12:30:00', 1510664400, '14.11.17 15:00:00', '2017-11-05 23:45:54', NULL, 1),
(55, 1, 1, 'event55', 1511605800, '25.11.17 12:30:00', 1511607600, '25.11.17 13:00:00', '2017-11-05 23:48:03', NULL, 1),
(56, 1, 1, 'event55', 1512210600, '02.12.17 12:30:00', 1512212400, '02.12.17 13:00:00', '2017-11-05 23:48:03', 55, 0),
(57, 1, 1, 'event55', 1512815400, '09.12.17 12:30:00', 1512817200, '09.12.17 13:00:00', '2017-11-05 23:48:03', 55, 0),
(58, 1, 1, 'event55', 1513420200, '16.12.17 12:30:00', 1513422000, '16.12.17 13:00:00', '2017-11-05 23:48:03', 55, 0),
(59, 1, 1, 'event55', 1514025000, '23.12.17 12:30:00', 1514026800, '23.12.17 13:00:00', '2017-11-05 23:48:03', 55, 0),
(60, 1, 1, 'event22', 1511512200, '11.24.17 10:30:00', 1511517600, '11.24.17 12:00:00', '2017-11-05 23:49:25', NULL, 1),
(61, 1, 1, 'event22', 1512117000, '12.01.17 10:30:00', 1512122400, '12.01.17 12:00:00', '2017-11-05 23:49:25', 60, 0),
(62, 1, 1, 'event22', 1512721800, '12.08.17 10:30:00', 1512727200, '12.08.17 12:00:00', '2017-11-05 23:49:25', 60, 0),
(63, 1, 1, 'event22', 1513326600, '12.15.17 10:30:00', 1513332000, '12.15.17 12:00:00', '2017-11-05 23:49:25', 60, 0),
(64, 1, 1, 'event22', 1513931400, '12.22.17 10:30:00', 1513936800, '12.22.17 12:00:00', '2017-11-05 23:49:25', 60, 0),
(67, 1, 1, 'event22', 1510248600, '11.09.17 19:30:00', 1510250400, '11.09.17 20:00:00', '2017-11-05 23:51:34', NULL, 1),
(68, 1, 1, 'event22@', 1511458200, '23.11.17 19:30:00', 1511460000, '23.11.17 20:00:00', '2017-11-05 23:51:34', 67, 0),
(69, 1, 1, 'event', 1512667800, '07.12.17 19:30:00', 1512669600, '07.12.17 20:00:00', '2017-11-05 23:51:34', 67, 0),
(70, 1, 1, 'ergtr', 1514613600, '12.30.17 08:00:00', 1514640600, '12.30.17 15:30:00', '2017-11-06 00:20:36', NULL, 1),
(71, 1, 1, 'ergtr', 1515823200, '01.13.18 08:00:00', 1515850200, '01.13.18 15:30:00', '2017-11-06 00:20:36', 70, 0),
(72, 1, 1, 'ergtr', 1517032800, '01.27.18 08:00:00', 1517059800, '01.27.18 15:30:00', '2017-11-06 00:20:37', 70, 0),
(73, 1, 2, 'erwe', 1509948000, '11.06.17 08:00:00', 1509953400, '11.06.17 09:30:00', '2017-11-06 00:41:11', NULL, 1),
(74, 1, 2, 'erwe', 1510552800, '11.13.17 08:00:00', 1510558200, '11.13.17 09:30:00', '2017-11-06 00:41:11', 73, 0),
(75, 1, 2, 'erwe', 1511157600, '11.20.17 08:00:00', 1511163000, '11.20.17 09:30:00', '2017-11-06 00:41:11', 73, 0),
(76, 1, 2, 'erwe', 1511762400, '11.27.17 08:00:00', 1511767800, '11.27.17 09:30:00', '2017-11-06 00:41:11', 73, 0),
(77, 1, 2, 'erwe', 1512367200, '12.04.17 08:00:00', 1512372600, '12.04.17 09:30:00', '2017-11-06 00:41:11', 73, 0),
(78, 1, 2, 'event_7_12', 1512633600, '12.07.17 10:00:00', 1512639000, '12.07.17 11:30:00', '2017-11-06 20:39:44', NULL, 1),
(79, 1, 2, 'event_7_12', 1513843200, '12.21.17 10:00:00', 1513848600, '12.21.17 11:30:00', '2017-11-06 20:39:44', 78, 0),
(80, 1, 2, 'event_7_12', 1515052800, '01.04.18 10:00:00', 1515058200, '01.04.18 11:30:00', '2017-11-06 20:39:44', 78, 0),
(81, 1, 2, '', 1512115200, '12.01.17 10:00:00', 1512117000, '12.01.17 10:30:00', '2017-11-06 20:41:03', NULL, 1),
(82, 1, 2, '', 1512720000, '12.08.17 10:00:00', 1512721800, '12.08.17 10:30:00', '2017-11-06 20:41:03', 81, 0),
(83, 1, 2, '', 1513324800, '12.15.17 10:00:00', 1513326600, '12.15.17 10:30:00', '2017-11-06 20:41:03', 81, 0),
(84, 1, 2, '', 1513929600, '12.22.17 10:00:00', 1513931400, '12.22.17 10:30:00', '2017-11-06 20:41:03', 81, 0),
(85, 1, 2, '', 1514534400, '12.29.17 10:00:00', 1514536200, '12.29.17 10:30:00', '2017-11-06 20:41:03', 81, 0),
(86, 1, 3, '', 1510034400, '11.07.17 08:00:00', 1510039800, '11.07.17 09:30:00', '2017-11-06 20:44:16', NULL, 1),
(87, 1, 3, '', 1511244000, '11.21.17 08:00:00', 1511249400, '11.21.17 09:30:00', '2017-11-06 20:44:16', 86, 0),
(88, 1, 3, '', 1512453600, '12.05.17 08:00:00', 1512459000, '12.05.17 09:30:00', '2017-11-06 20:44:16', 86, 0),
(89, 1, 3, 'Ñ‚ÐµÑÑ‚', 1510729200, '11.15.17 09:00:00', 1510731000, '11.15.17 09:30:00', '2017-11-07 06:40:31', NULL, 1),
(91, 1, 1, '', 1510387200, '11.11.17 10:00:00', 1510389000, '11.11.17 10:30:00', '2017-11-07 07:43:59', NULL, 0),
(92, 1, 1, 'wew', 1510401600, '11.11.17 14:00:00', 1510407000, '11.11.17 15:30:00', '2017-11-07 07:56:58', NULL, 0),
(93, 1, 1, 'wew', 1510408800, '11.11.17 16:00:00', 1510414200, '11.11.17 17:30:00', '2017-11-07 07:57:51', NULL, 0),
(94, 1, 1, 'ewwerw', 1510484400, '12.11.17 13:00:00', 1510486200, '12.11.17 13:30:00', '2017-11-07 07:59:32', NULL, 0),
(95, 1, 1, 'ewwerw', 1510491600, '12.11.17 15:00:00', 1510497000, '12.11.17 16:30:00', '2017-11-07 08:03:08', NULL, 0),
(96, 1, 1, 'ewwerw', 1510497000, '12.11.17 16:30:00', 1510498800, '12.11.17 17:00:00', '2017-11-07 08:03:48', NULL, 1),
(97, 1, 1, 'ewwerw', 1510504200, '12.11.17 18:30:00', 1510506000, '12.11.17 19:00:00', '2017-11-07 08:07:25', NULL, 1),
(102, 1, 2, 'ghfgh', 1510736400, '15.11.17 11:00:00', 1510738200, '15.11.17 11:30:00', '2017-11-07 08:23:59', NULL, 1),
(103, 1, 2, 'ghfgh', 1511946000, '29.11.17 11:00:00', 1511947800, '29.11.17 11:30:00', '2017-11-07 08:23:59', 102, 0),
(104, 1, 2, 'ghfgh', 1513155600, '13.12.17 11:00:00', 1513157400, '13.12.17 11:30:00', '2017-11-07 08:24:00', 102, 0),
(105, 1, 2, 'dtyrt', 1512907200, '10.12.17 14:00:00', 1512912600, '10.12.17 15:30:00', '2017-11-07 08:27:03', NULL, 1),
(106, 1, 2, 'dtyrt', 1514116800, '24.12.17 14:00:00', 1514122200, '24.12.17 15:30:00', '2017-11-07 08:27:03', 105, 0),
(107, 1, 2, 'dtyrt', 1515326400, '07.01.18 14:00:00', 1515331800, '07.01.18 15:30:00', '2017-11-07 08:27:03', 105, 0),
(108, 1, 2, '', 1513774800, '20.12.17 15:00:00', 1513787400, '20.12.17 18:30:00', '2017-11-07 08:28:04', NULL, 1),
(109, 1, 2, '', 1514984400, '03.01.18 15:00:00', 1514997000, '03.01.18 18:30:00', '2017-11-07 08:28:04', 108, 0),
(110, 1, 2, '', 1516194000, '17.01.18 15:00:00', 1516206600, '17.01.18 18:30:00', '2017-11-07 08:28:04', 108, 0),
(111, 1, 2, 'sdsde', 1513517400, '17.12.17 15:30:00', 1513519200, '17.12.17 16:00:00', '2017-11-07 09:09:28', NULL, 1),
(112, 1, 2, 'sdsde', 1514122200, '24.12.17 15:30:00', 1514124000, '24.12.17 16:00:00', '2017-11-07 09:09:28', 111, 0),
(113, 1, 2, 'sdsde', 1513521000, '17.12.17 16:30:00', 1513522800, '17.12.17 17:00:00', '2017-11-07 09:09:43', NULL, 1),
(114, 1, 2, 'sdsde', 1514125800, '24.12.17 16:30:00', 1514127600, '24.12.17 17:00:00', '2017-11-07 09:09:43', 113, 0),
(115, 1, 2, 'sdsde', 1514730600, '31.12.17 16:30:00', 1514732400, '31.12.17 17:00:00', '2017-11-07 09:09:43', 113, 0),
(116, 1, 2, '', 1510308000, '10.11.17 12:00:00', 1510309800, '10.11.17 12:30:00', '2017-11-07 09:16:08', NULL, 0),
(117, 1, 2, 'iyuy', 1514307600, '26.12.17 19:00:00', 1514311200, '26.12.17 20:00:00', '2017-11-07 09:27:32', NULL, 0),
(118, 1, 2, 'iyuy', 1514221200, '25.12.17 19:00:00', 1514224800, '25.12.17 20:00:00', '2017-11-07 09:31:26', NULL, 0),
(119, 1, 2, 'iyuy', 1511629200, '25.11.17 19:00:00', 1511632800, '25.11.17 20:00:00', '2017-11-07 09:32:08', NULL, 1),
(120, 1, 1, 'y54y567', 1510853400, '16.11.17 19:30:00', 1510855200, '16.11.17 20:00:00', '2017-11-07 09:34:16', NULL, 1),
(121, 1, 1, 'sdswe', 1510905600, '17.11.17 10:00:00', 1510909200, '17.11.17 11:00:00', '2017-11-07 09:39:26', NULL, 1),
(122, 1, 1, 'dgdgfr', 1510992000, '18.11.17 10:00:00', 1511004600, '18.11.17 13:30:00', '2017-11-07 09:42:29', NULL, 1),
(123, 4, 1, 'test parent', 1513166400, '13.12.17 14:00:00', 1513171800, '13.12.17 15:30:00', '2017-11-07 09:46:51', NULL, 1),
(124, 4, 1, 'test parent', 1513771200, '20.12.17 14:00:00', 1513776600, '20.12.17 15:30:00', '2017-11-07 09:46:51', 123, 0),
(125, 4, 1, 'test parent', 1514376000, '27.12.17 14:00:00', 1514381400, '27.12.17 15:30:00', '2017-11-07 09:46:51', 123, 0),
(129, 1, 1, 'rtyry', 1513422000, '16.12.17 13:00:00', 1513432800, '16.12.17 16:00:00', '2017-11-07 09:49:34', 128, 0),
(132, 6, 3, 'dgdf', 1510124400, '08.11.17 09:00:00', 1510128000, '08.11.17 10:00:00', '2017-11-07 09:53:15', NULL, 1),
(134, 1, 3, 'dgdf', 1510131600, '08.11.17 11:00:00', 1510138800, '08.11.17 13:00:00', '2017-11-07 09:54:31', NULL, 1),
(137, 1, 3, 'dgdf', 1510138800, '08.11.17 13:00:00', 1510146000, '08.11.17 15:00:00', '2017-11-07 09:55:17', NULL, 1),
(138, 1, 3, 'dgdf', 1510743600, '15.11.17 13:00:00', 1510750800, '15.11.17 15:00:00', '2017-11-07 09:55:17', 137, 0),
(146, 1, 2, 'dsfsf', 1513234800, '14.12.17 09:00:00', 1513242000, '14.12.17 11:00:00', '2017-11-07 10:01:05', NULL, 1),
(147, 1, 2, 'dsfsf', 1514444400, '28.12.17 09:00:00', 1514451600, '28.12.17 11:00:00', '2017-11-07 10:01:05', 146, 0),
(148, 1, 2, 'dfgt', 1512630000, '07.12.17 09:00:00', 1512633600, '07.12.17 10:00:00', '2017-11-07 10:04:11', NULL, 1),
(149, 1, 2, 'dfgt', 1513839600, '21.12.17 09:00:00', 1513843200, '21.12.17 10:00:00', '2017-11-07 10:04:11', 148, 0),
(150, 1, 1, '5y76', 1515396600, '08.01.18 09:30:00', 1515398400, '08.01.18 10:00:00', '2017-11-08 08:10:56', NULL, 1),
(151, 1, 1, '5y76', 1516001400, '15.01.18 09:30:00', 1516003200, '15.01.18 10:00:00', '2017-11-08 08:10:56', 150, 0),
(152, 1, 3, 'efterter', 1510227000, '09.11.17 13:30:00', 1510228800, '09.11.17 14:00:00', '2017-11-09 11:02:16', NULL, 1),
(153, 1, 3, 'efterter', 1511436600, '23.11.17 13:30:00', 1511438400, '23.11.17 14:00:00', '2017-11-09 11:02:17', 152, 0),
(154, 1, 3, '', 1510831800, '16.11.17 13:30:00', 1510833600, '16.11.17 14:00:00', '2017-11-09 11:03:43', NULL, 1),
(155, 1, 3, '', 1512041400, '30.11.17 13:30:00', 1512043200, '30.11.17 14:00:00', '2017-11-09 11:03:43', 154, 0),
(156, 1, 1, 'w5@y6y675', 1510300800, '10.11.17 10:00:00', 1510302600, '10.11.17 10:30:00', '2017-11-10 07:39:40', NULL, 0);

-- --------------------------------------------------------

--
-- Структура таблицы `rolebooker`
--

CREATE TABLE `rolebooker` (
  `id` int(11) NOT NULL,
  `name` varchar(10) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- Дамп данных таблицы `rolebooker`
--

INSERT INTO `rolebooker` (`id`, `name`) VALUES
(1, 'admin'),
(2, 'user');

-- --------------------------------------------------------

--
-- Структура таблицы `roombooker`
--

CREATE TABLE `roombooker` (
  `id` int(11) NOT NULL,
  `name` varchar(15) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- Дамп данных таблицы `roombooker`
--

INSERT INTO `roombooker` (`id`, `name`) VALUES
(1, 'Boardroom1'),
(2, 'Boardroom2'),
(3, 'Boardroom3');

-- --------------------------------------------------------

--
-- Структура таблицы `userbooker`
--

CREATE TABLE `userbooker` (
  `id` int(11) NOT NULL,
  `fullname` varchar(60) NOT NULL,
  `login` varchar(30) NOT NULL,
  `password` varchar(32) NOT NULL,
  `email` varchar(50) NOT NULL,
  `role_id` int(11) NOT NULL,
  `status` varchar(32) NOT NULL,
  `time_life` int(11) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- Дамп данных таблицы `userbooker`
--

INSERT INTO `userbooker` (`id`, `fullname`, `login`, `password`, `email`, `role_id`, `status`, `time_life`) VALUES
(1, 'test user', 'test123', '78ceb0db205009fe9b3a58f22a87ded4', 'test@mail.ru', 1, '72b6fddfe60b20cc98e64b46b10d00b8', 1510352747),
(2, 'simple user', 'user123', 'f77a0730f77a408a451d534450e9be22', 'userS@gmail.com', 2, 'c8fc6e2b1135aacf39687a358ddf210d', 1510386864),
(3, 'testing user', 'testing', '05b22f58513cb79642132b62a9cfaf5a', 'testing@rambler.ru', 2, 'efcde355c302f30c6ae79cd93a682373', 1509710216),
(4, 'rob new', '123456', '82308abf2be2a867b8a0249cff96ad0d', 'rob1@mail.ru', 1, '66d489ad42a915c384d295fc96e37669', 1510208648);

--
-- Триггеры `userbooker`
--
DELIMITER $$
CREATE TRIGGER `delete_events` AFTER DELETE ON `userbooker` FOR EACH ROW begin
	delete from eventBooker where start_event >= UNIX_TIMESTAMP(NOW()) and user_id = old.id;
end
$$
DELIMITER ;

--
-- Индексы сохранённых таблиц
--

--
-- Индексы таблицы `eventbooker`
--
ALTER TABLE `eventbooker`
  ADD PRIMARY KEY (`id`),
  ADD KEY `eventBooker_fk0` (`user_id`),
  ADD KEY `eventBooker_fk1` (`room_id`);

--
-- Индексы таблицы `rolebooker`
--
ALTER TABLE `rolebooker`
  ADD PRIMARY KEY (`id`);

--
-- Индексы таблицы `roombooker`
--
ALTER TABLE `roombooker`
  ADD PRIMARY KEY (`id`);

--
-- Индексы таблицы `userbooker`
--
ALTER TABLE `userbooker`
  ADD PRIMARY KEY (`id`),
  ADD KEY `userBooker_fk0` (`role_id`);

--
-- AUTO_INCREMENT для сохранённых таблиц
--

--
-- AUTO_INCREMENT для таблицы `eventbooker`
--
ALTER TABLE `eventbooker`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=157;
--
-- AUTO_INCREMENT для таблицы `rolebooker`
--
ALTER TABLE `rolebooker`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=3;
--
-- AUTO_INCREMENT для таблицы `roombooker`
--
ALTER TABLE `roombooker`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=4;
--
-- AUTO_INCREMENT для таблицы `userbooker`
--
ALTER TABLE `userbooker`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=5;
--
-- Ограничения внешнего ключа сохраненных таблиц
--

--
-- Ограничения внешнего ключа таблицы `eventbooker`
--
ALTER TABLE `eventbooker`
  ADD CONSTRAINT `eventBooker_fk1` FOREIGN KEY (`room_id`) REFERENCES `roombooker` (`id`);

--
-- Ограничения внешнего ключа таблицы `userbooker`
--
ALTER TABLE `userbooker`
  ADD CONSTRAINT `userBooker_fk0` FOREIGN KEY (`role_id`) REFERENCES `rolebooker` (`id`);

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
